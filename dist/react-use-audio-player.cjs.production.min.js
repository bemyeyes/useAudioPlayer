"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,o=require("react"),t=require("howler");function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function l(e){if(void 0===e)return{src:null,isReady:!1,isLoading:!1,looping:!1,duration:0,rate:1,volume:1,muted:!1,playing:!1,paused:!1,stopped:!1,error:null};var o=e.seek(),t=e.playing();return{isReady:"loaded"===e.state(),isLoading:"loading"===e.state(),src:e._src,looping:e.loop(),duration:e.duration(),rate:e.rate(),volume:e.volume(),muted:e.mute(),playing:t,paused:!t,stopped:!t&&0===o,error:null}}function a(o,t){switch(t.type){case e.START_LOAD:return n({},l(),{isLoading:!0});case e.ON_LOAD:return"unloaded"===t.howl.state()?o:l(t.howl);case e.ON_ERROR:return n({},l(),{error:t.message});case e.ON_PLAY:return n({},o,{playing:!0,paused:!1,stopped:!1});case e.ON_PAUSE:return n({},o,{playing:!1,paused:!0});case e.ON_STOP:return n({},o,{playing:!1,paused:!1,stopped:!0});case e.ON_END:return n({},o,{playing:o.looping,stopped:!o.looping});case e.ON_MUTE:var a;return n({},o,{muted:null!==(a=t.howl.mute())&&void 0!==a&&a});case e.ON_RATE:var u,r;return n({},o,{rate:null!==(u=null===(r=t.howl)||void 0===r?void 0:r.rate())&&void 0!==u?u:1});case e.ON_VOLUME:var i,s;return n({},o,{volume:null!==(i=null===(s=t.howl)||void 0===s?void 0:s.volume())&&void 0!==i?i:1});case e.ON_LOOP:var c=t.toggleValue,v=void 0!==c&&c;return t.howl.loop(v),n({},o,{looping:v});default:return o}}function u(t,n){var l=n[0],a=n[1],u=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_LOAD,howl:o})}),[a,t]),r=o.useCallback((function(o,t){a({type:e.ON_ERROR,message:t})}),[a]),i=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_PLAY,howl:o})}),[a,t]),s=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_PAUSE,howl:o})}),[a,t]),c=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_END,howl:o})}),[a,t]),v=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_STOP,howl:o})}),[a,t]),f=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_MUTE,howl:o})}),[a,t]),d=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_VOLUME,howl:o})}),[a,t]),p=o.useCallback((function(){var o=t.getHowl();void 0!==o&&a({type:e.ON_RATE,howl:o})}),[a,t]);return o.useEffect((function(){return function(){var e=t.getHowl();null==e||e.off("loaderror",r),null==e||e.off("playerror",r),null==e||e.off("play",i),null==e||e.off("pause",s),null==e||e.off("end",c),null==e||e.off("stop",v),null==e||e.off("mute",f),null==e||e.off("volume",d),null==e||e.off("rate",p)}}),[]),[l,o.useRef((function(o){if(o.type===e.START_LOAD){var t=o.howl;t.once("load",u),t.on("loaderror",r),t.on("playerror",r),t.on("play",i),t.on("pause",s),t.on("end",c),t.on("stop",v),t.on("mute",f),t.on("volume",d),t.on("rate",p)}a(o)})).current]}!function(e){e.START_LOAD="START_LOAD",e.ON_LOAD="ON_LOAD",e.ON_ERROR="ON_ERROR",e.ON_PLAY="ON_PLAY",e.ON_PAUSE="ON_PAUSE",e.ON_STOP="ON_STOP",e.ON_END="ON_END",e.ON_RATE="ON_RATE",e.ON_MUTE="ON_MUTE",e.ON_VOLUME="ON_VOLUME",e.ON_LOOP="ON_LOOP"}(e||(e={}));var r=["initialVolume","initialRate","initialMute"],i=function(){function o(){this.callbacks=new Map,this.howl=void 0,this.options={},this.subscriptionIndex=0}var l=o.prototype;return l.subscribe=function(e){var o=(this.subscriptionIndex++).toString();return this.callbacks.set(o,e),o},l.unsubscribe=function(e){this.callbacks.delete(e)},l.getHowl=function(){return this.howl},l.getHowler=function(){return t.Howler},l.getNumberOfConnections=function(){return this.callbacks.size},l.createHowl=function(o){this.destroyHowl(),this.options=o;var l=this.options,a=l.initialVolume,u=l.initialRate,i=l.initialMute,s=function(e,o){if(null==e)return{};var t,n,l={},a=Object.keys(e);for(n=0;n<a.length;n++)o.indexOf(t=a[n])>=0||(l[t]=e[t]);return l}(l,r),c=new t.Howl(n({mute:i,volume:a,rate:u},s));return this.callbacks.forEach((function(o){return o({type:e.START_LOAD,howl:c})})),this.howl=c,c},l.destroyHowl=function(){var e,o,t,n,l,a;this.options.onload&&(null===(o=this.howl)||void 0===o||o.off("load",this.options.onload)),this.options.onend&&(null===(t=this.howl)||void 0===t||t.off("end",this.options.onend)),this.options.onplay&&(null===(n=this.howl)||void 0===n||n.off("play",this.options.onplay)),this.options.onpause&&(null===(l=this.howl)||void 0===l||l.off("pause",this.options.onpause)),this.options.onstop&&(null===(a=this.howl)||void 0===a||a.off("stop",this.options.onstop)),null===(e=this.howl)||void 0===e||e.unload()},l.broadcast=function(e){this.callbacks.forEach((function(o){return o(e)}))},o}(),s=function(){function e(){}return e.getInstance=function(){return void 0===this.instance&&(e.instance=new i),e.instance},e}();s.instance=void 0,exports.useAudioPlayer=function(){var t=o.useRef(null),r=o.useRef(null);function s(){if(null!==t.current)return t.current;var e=new i;return t.current=e,r.current=e.getHowler(),e}var c=u(s(),o.useReducer(a,s().getHowl(),l)),v=c[0],f=c[1],d=o.useCallback((function(){for(var o=arguments.length,t=new Array(o),l=0;l<o;l++)t[l]=arguments[l];var a=t[0],u=t[1],r=void 0===u?{}:u,i=s().createHowl(n({src:a},r));f({type:e.START_LOAD,howl:i})}),[]),p=o.useCallback((function(e){var o=s().getHowl();void 0!==o&&o.seek(e)}),[]),w=o.useCallback((function(){var e,o=s().getHowl();return void 0===o?0:null!==(e=o.seek())&&void 0!==e?e:0}),[]),O=o.useCallback((function(){var e=s().getHowl();void 0!==e&&e.play()}),[]),g=o.useCallback((function(){var e=s().getHowl();void 0!==e&&e.pause()}),[]),h=o.useCallback((function(){var e=s().getHowl();void 0!==e&&(v.playing?e.pause():e.play())}),[v]),b=o.useCallback((function(){var e=s().getHowl();void 0!==e&&e.stop()}),[]),y=o.useCallback((function(e,o,t){var n=s().getHowl();void 0!==n&&n.fade(e,o,t)}),[]),_=o.useCallback((function(e){var o=s().getHowl();void 0!==o&&o.rate(e)}),[]),k=o.useCallback((function(e){var o=s().getHowl();void 0!==o&&o.volume(e)}),[]),N=o.useCallback((function(e){var o=s().getHowl();void 0!==o&&o.mute(e)}),[]),H=o.useCallback((function(o){var t=s().getHowl();void 0!==t&&f({type:e.ON_LOOP,howl:t,toggleValue:o})}),[]),A=o.useCallback((function(){var e;null===(e=s())||void 0===e||e.destroyHowl()}),[]);return n({},v,{load:d,seek:p,getPosition:w,play:O,pause:g,togglePlayPause:h,stop:b,mute:N,fade:y,setRate:_,setVolume:k,loop:H,cleanup:A,howlManager:t,howlerGlobal:r})},exports.useGlobalAudioPlayer=function(){var t=o.useRef(s.getInstance()),r=u(t.current,o.useReducer(a,t.current.getHowl(),l)),i=r[0],c=r[1];o.useEffect((function(){var o=t.current.getHowl();void 0!==o&&(c({type:e.START_LOAD,howl:o}),"loaded"===o.state()&&c({type:e.ON_LOAD,howl:o}));var n=t.current.subscribe((function(e){c(e)}));return function(){t.current.unsubscribe(n)}}),[]);var v=o.useCallback((function(){for(var e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];var a=o[0],u=o[1],r=void 0===u?{}:u;t.current.createHowl(n({src:a},r))}),[]),f=o.useCallback((function(e){var o=t.current.getHowl();void 0!==o&&o.seek(e)}),[]),d=o.useCallback((function(){var e,o=t.current.getHowl();return void 0===o?0:null!==(e=o.seek())&&void 0!==e?e:0}),[]),p=o.useCallback((function(){var e=t.current.getHowl();void 0!==e&&e.play()}),[]),w=o.useCallback((function(){var e=t.current.getHowl();void 0!==e&&e.pause()}),[]),O=o.useCallback((function(){var e=t.current.getHowl();void 0!==e&&(i.playing?e.pause():e.play())}),[i]),g=o.useCallback((function(){var e=t.current.getHowl();void 0!==e&&e.stop()}),[]),h=o.useCallback((function(e,o,n){var l=t.current.getHowl();void 0!==l&&l.fade(e,o,n)}),[]),b=o.useCallback((function(e){var o=t.current.getHowl();void 0!==o&&o.rate(e)}),[]),y=o.useCallback((function(e){var o=t.current.getHowl();void 0!==o&&o.volume(e)}),[]),_=o.useCallback((function(e){var o=t.current.getHowl();void 0!==o&&o.mute(e)}),[]),k=o.useCallback((function(o){var n=t.current.getHowl();void 0!==n&&t.current.broadcast({type:e.ON_LOOP,howl:n,toggleValue:o})}),[]);return n({},i,{load:v,seek:f,getPosition:d,play:p,pause:w,togglePlayPause:O,stop:g,mute:_,fade:h,setRate:b,setVolume:y,loop:k})};
//# sourceMappingURL=react-use-audio-player.cjs.production.min.js.map
